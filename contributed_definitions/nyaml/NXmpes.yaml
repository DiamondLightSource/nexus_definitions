category: application
doc: |
  This is the most general application definition for multidimensional
  photoelectron spectroscopy.
type: group
NXmpes(NXobject):
  (NXentry):
    title:
    start_time(NX_DATE_TIME):
      doc: |
        Datetime of the start of the measurement.
    end_time(NX_DATE_TIME):
      doc: |
        Datetime of the end of the measurement.
    method:
      doc: |
        A name of the experimental method according
        to the `ISO 18115-1:2023`_ specification.
        
        .. _ISO 18115-1:2023: https://www.iso.org/standard/74811.html
    definition:
      \@version:
      enumeration: [NXmpes]
    (NXuser):
      exists: recommended
      doc: |
        Contact information of at least the user of the instrument or the investigator
        who performed this experiment. Adding multiple users if relevant is recommended.
      name:
        doc: |
          Name of the user.
      affiliation:
        exists: recommended
        doc: |
          Name of the affiliation of the user at the point in time when the experiment was
          performed.
      address:
        exists: recommended
        doc: |
          Full address (street, street number, ZIP, city, country) of the user's
          affiliation.
      email:
        doc: |
          Email address of the user.
      orcid:
        exists: recommended
        doc: |
          Author ID defined by https://orcid.org/.
    (NXinstrument):
      energy_resolution(NX_FLOAT):
        unit: NX_ENERGY
        exists: recommended
      source_beam(NXsource):
        
        # Comment from mpes may workshop:
        # - Add linking between source and beam
        # - There is much more information which can be provided for NXsource
        doc: |
          The source used to generate the primary photons. Properties refer strictly to
          parameters of the source, not of the output beam. For example, the energy of the
          source is not the optical power of the beam, but the energy of the electron beam
          in a synchrotron and so on.
        type:
          enumeration: [Synchrotron X-ray Source, Rotating Anode X-ray, Fixed Tube X-ray, UV Laser, Free-Electron Laser, Optical Laser, UV Plasma Source, Metal Jet X-ray, HHG laser, UV lamp, Monochromatized electron source, other]
        type_other:
          exists: optional
          doc: |
            Specification of type, may also go to name.
        name:
          exists: recommended
        probe:
          doc: |
            Type of probe. In photoemission it's always photons, so the full NIAC list is
            restricted.
          enumeration: [photons]
      beam_probe(NXbeam):
        
        # Comment from mpes may workshop: Add linking between source and beam
        
        # Add extent as recommended?
        distance(NX_NUMBER):
          unit: NX_LENGTH
          exists: recommended
          doc: |
            Distance of the point of evaluation of the beam from the sample surface.
        incident_energy(NX_FLOAT):
          unit: NX_ENERGY
        incident_energy_spread(NX_NUMBER):
          exists: recommended
          unit: NX_ENERGY
        incident_polarization(NX_NUMBER):
          exists: recommended
          unit: NX_ANY
      (NXelectronanalyser):
        model(NXfabrication):
          exists: recommended
          vendor:
            exists: recommended
          model:
            exists: recommended
          identifier:
            exists: recommended
        description:
        energy_resolution(NX_FLOAT):
          exists: recommended
          unit: NX_ENERGY
          doc: |
            Energy resolution of the analyser with the current setting. May be linked from a
            NXcalibration.
        fast_axes(NX_CHAR):
          exists: recommended
        slow_axes:
          exists: recommended
        (NXcollectioncolumn):
          
          # TODO: Comment from Anders Frisk on proposal page
          # What is the definition of a collection column?
          # Optional constant settings (like lens focusing parameters on the sample: position_x, position_y, working_distance)
          scheme:
            doc: |
              Scheme of the electron collection column.
            enumeration: [Standard, Angular dispersive, Spatial dispersive, Selective area, Deflector, PEEM, Momentum Microscope]
          mode:
            exists: recommended
          
          # TODO: What does this refer to. It is currently not in the collection column base class
          projection:
            exists: recommended
          field_aperture(NXaperture):
            exists: optional
            doc: |
              The size and position of the field aperture inserted in the column. To add
              additional or other apertures use the APERTURE group of NXcollectioncolumn.
          contrast_aperture(NXaperture):
            exists: optional
            doc: |
              The size and position of the contrast aperture inserted in the column. To add
              additional or other apertures use the APERTURE group of NXcollectioncolumn.
        (NXenergydispersion):
          scheme:
            enumeration: [tof, hemispherical, double hemispherical, cylindrical mirror, display mirror, retarding grid]
          pass_energy(NX_FLOAT):
            unit: NX_ENERGY
          energy_scan_mode:
          entrance_slit(NXaperture):
            exists: optional
            doc: |
              Size, position and shape of the entrance slit in dispersive analyzers. To add
              additional or other slits use the APERTURE group of NXenergydispersion.
          exit_slit(NXaperture):
            exists: optional
            doc: |
              Size, position and shape of the exit slit in dispersive analyzers. To add
              additional or other slits use the APERTURE group of NXenergydispersion.
        (NXdetector):
          amplifier_type:
            exists: recommended
            doc: |
              Type of electron amplifier in the first amplification step.
            enumeration: [MCP, channeltron]
          detector_type:
            exists: recommended
            doc: |
              Description of the detector type.
            enumeration: [DLD, Phosphor+CCD, Phosphor+CMOS, ECMOS, Anode, Multi-anode]
          (NXdata):
            exists: recommended
            
            # TODO: Anders Frisk on proposal page
            # It could be a lot of raw data from a detector. Shpould be optional.
            \@signal:
              enumeration: [raw]
            raw(NX_NUMBER):
              doc: |
                Raw data before calibration.
      (NXmanipulator):
        exists: optional
        doc: |
          Manipulator for positioning of the sample.
        
        # These fields should be NXenvironments and should be changed once NXmanipulator is refactored.
        sample_temperature(NXenvironment):
          exists: recommended
          unit: NX_TEMPERATURE
        drain_current(NX_FLOAT):
          exists: recommended
          unit: NX_CURRENT
        sample_bias(NX_FLOAT):
          exists: recommended
          unit: NX_CURRENT
    (NXprocess):
      exists: recommended
      doc: |
        Document an event of data processing, reconstruction, or analysis for this data.
        Describe the appropriate axis calibrations for your experiment using one or more
        of the following NXcalibrations
      energy_calibration(NXcalibration):
        exists: optional
        applied(NX_BOOLEAN):
          doc: |
            Has an energy calibration been applied?
        calibrated_axis(NX_FLOAT):
          exists: recommended
          doc: |
            This is the calibrated energy axis to be used for data plotting.
      angular_calibration(NXcalibration):
        exists: optional
        applied(NX_BOOLEAN):
          doc: |
            Has an angular calibration been applied?
        calibrated_axis(NX_FLOAT):
          exists: recommended
          doc: |
            This is the calibrated angular axis to be used for data plotting.
      spatial_calibration(NXcalibration):
        exists: optional
        applied(NX_BOOLEAN):
          doc: |
            Has an spatial calibration been applied?
        calibrated_axis(NX_FLOAT):
          exists: recommended
          doc: |
            This is the calibrated spatial axis to be used for data plotting.
      momentum_calibration(NXcalibration):
        exists: optional
        applied(NX_BOOLEAN):
          doc: |
            Has an momentum calibration been applied?
        calibrated_axis(NX_FLOAT):
          exists: recommended
          doc: |
            This is the momentum axis to be used for data plotting.
    (NXsample):
      name:
      (NXsubstance):
        doc: |
          For samples containing a single pure substances. For mixtures use the
          NXsample_component_set and NXsample_component group in NXsample instead.
        molecular_formula_hill:
          exists: recommended
          doc: |
            The chemical formula of the sample.
      atom_types:
        exists: recommended
        doc: |
          List of comma-separated elements from the periodic table
          that are contained in the sample.
          If the sample substance has multiple components, all
          elements from each component must be included in `atom_types`.
      situation:
        enumeration: [vacuum, inert atmosphere, oxidising atmosphere, reducing atmosphere]
      (NXsample_history):
        exists: recommended
        doc: |
          A set of activities that occurred to the sample prior to/during photoemission experiment.
          
          Ideally, a full report of the previous operations (or links to a chain of operations).
          Alternatively, notes allow for additional descriptors in any format
          (NXnote allows to add pictures, audio, movies). Alternatively, a
          reference to the location or a unique identifier or other metadata file. In the
          case these are not available, free-text description.
        sample_preparation(NXphysical_process):
          exists: recommended
          doc: |
            Details about the sample preparation for the MPES experiment (i.e. cleaving, last
            annealing).
          start_time(NX_DATE_TIME):
          end_time(NX_DATE_TIME):
            exists: recommended
          method:
            exists: optional
            doc: |
              Details about the method of sample preparation before the MPES experiment.
          notes:
            exists: optional
      temperature(NXenvironment):
        exists: recommended
        doc: |
          Measured sample temperature.
          
          This field may also be found in NXmanipulator if present.
          In that case, this should be a link to /entry/instrument/manipulator/sample_temperature.
        thermocouple(NXsensor):
          name:
          type:
            exists: recommended
          value(NX_FLOAT):
            exists: recommended
            unit: NX_TEMPERATURE
            doc: |
              In the case of a fixed temperature measurement, this is the scalar temperature of
              the sample.
          value_log(NXlog):
            exists: optional
            unit: NX_TEMPERATURE
            doc: |
              In the case of an experiment in which the temperature is changed and recorded,
              this is an array of length m of temperatures.
      gas_pressure(NXenvironment):
        exists: recommended
        doc: |
          Gas pressure surrounding the sample.
          
          This field may also be found in NXinstrument if present.
          In that case, this should be a link to /entry/instrument/gas_pressure.
        pressure_gauge(NXsensor):
          name:
          type:
            exists: recommended
          value(NX_FLOAT):
            exists: recommended
            unit: NX_PRESSURE
            doc: |
              In the case of a fixed gas pressure measurement, this is the scalar gas pressure around
              the sample.
          value_log(NXlog):
            exists: optional
            unit: NX_PRESSURE
            doc: |
              In the case of an experiment in which the gas pressure is changed and recorded,
              this is an array of length m of gas pressures.
      bias(NXenvironment):
        exists: recommended
        doc: |
          Voltage applied to sample and sample holder.
          
          This field may also be found in NXmanipulator if present.
          In that case, this should be a link to /entry/instrument/manipulator/sample_bias.
        voltmeter(NXsensor):
          name:
          type:
            exists: recommended
          value(NX_FLOAT):
            exists: recommended
            unit: NX_VOLTAGE
            doc: |
              In the case of a fixed applied bias, this is the scalar voltage applied to
              sample and sample holder.
          value_log(NXlog):
            exists: optional
            unit: NX_VOLTAGE
            doc: |
              In the case of an experiment in which the bias is changed and recorded,
              this is an array of length m of voltages.
      drain_current(NXenvironment):
        exists: optional
        doc: |
          Drain current of the sample and sample holder.
          This field may also be found in NXmanipulator if present.
          In that case, this should be a link to /entry/instrument/manipulator/drain_current.
        amperemeter(NXsensor):
          name:
          type:
            exists: recommended
          value(NX_FLOAT):
            exists: recommended
            unit: NX_CURRENT
            doc: |
              In the case of a fixed current, this is the scalar drain current of the sample
              and sample holder.
          value_log(NXlog):
            exists: optional
            unit: NX_CURRENT
            doc: |
              In the case of an experiment in which the current changes and is recorded,
              this is an array of length m of drain currents.
    (NXdata):
      \@signal:
        enumeration: [data]
      data(NX_NUMBER):
        unit: NX_ANY
        doc: |
          Represents a measure of one- or more-dimensional photoemission counts, where the
          varied axis may be for example energy, momentum, spatial coordinate, pump-probe
          delay, spin index, temperature, etc. The axes traces should be linked to the
          actual encoder position in NXinstrument or calibrated axes in NXprocess.
