category: base
doc: |
  Base class for the configuration and results of a (static) reconstruction algorithm.
  
  Generating a tomographic reconstruction of the specimen uses selected and
  calibrated ion hit positions, the evaporation sequence, and voltage curve data.
  Very often scientists use own software scripts according to published procedures,
  so-called reconstruction protocols.
symbols:
  doc: |
    The symbols used in the schema to specify e.g. dimensions of arrays.
  n: |
    Number of ions spatially filtered from results of the hit_finding algorithm
    :ref:`NXapm_hit_finding` from which an instance of a reconstructed volume
    has been generated. These ions get new identifier assigned in the process -
    the so-called evaporation_identifier, which must not be confused with
    the pulse_identifier!
type: group
NXapm_reconstruction(NXprocess):
  # when evolving these ideas further inherit from NXapm_method instead
  (NXprogram):
  (NXserialized):
  # config/input
  protocol_name(NX_CHAR):
    doc: |
      Qualitative statement about which reconstruction protocol was used.
    enumeration: [bas, geiser, gault, cameca, other]
  crystallographic_calibration(NX_CHAR):
    doc: |
      Different strategies for crystallographic calibration of the
      reconstruction are possible. Therefore, we collect first such
      feedback before parameterizing this further.
      
      If no crystallographic calibration was performed, the field
      should be filled with the n/a, meaning not applied.
  # results
  reconstructed_positions(NX_FLOAT):
    doc: |
      Three-dimensional reconstructed positions of the ions.
    unit: NX_LENGTH
    dim: (n, 3)
    \@depends_on(NX_CHAR):
      doc: |
        The instance of :ref:`NXcoordinate_system`
        in which the positions are defined.
  naive_discretization(NXprocess):
    (NXprogram):
    # config/input
    # results
    (NXdata):
      doc: |
        To get a first visual overview of the reconstructed dataset,
        here a 3d histogram of the ion is stored. Ion counts are characterized
        using one nanometer cubic bins without applying position smoothening
        algorithms during the histogram computation.
